(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{152:function(e,t,n){"use strict";n(68),n(98),n(13),n(18);function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"DB_NAME",get:function(){return"MemoDB"}},{key:"STORE_NAME",get:function(){return"memo"}}],(n=[{key:"connect",value:function(){var t=this;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,r){if(t.db)n(t);else{var o=indexedDB.open(e.DB_NAME);o.onupgradeneeded=function(t){t.target.result.createObjectStore(e.STORE_NAME,{keyPath:"id",autoIncrement:!0})},o.onsuccess=function(e){t.db=e.target.result,n(t)}}})));case 1:case"end":return n.stop()}}))}},{key:"getTransaction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"readwrite";return this.db.transaction(e,t)}},{key:"getStore",value:function(){return this.getTransaction([e.STORE_NAME]).objectStore(e.STORE_NAME)}},{key:"add",value:function(data){this.getStore().add(data).onsuccess=function(){console.log("save success.")}}},{key:"remove",value:function(e){console.log(e),this.getStore().delete(e).onsuccess=function(){console.log("delete success.")}}},{key:"update",value:function(e,data){data.id=e,this.getStore().put(data).onsuccess=function(){console.log("update success.")}}},{key:"get",value:function(e){var t=this;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,r){var o=t.getStore().get(e);o.onsuccess=function(){var e=o.result,t={id:0,rawdata:""};e&&(t.id=e.id,t.rawdata=e.data),n(t)},o.onerror=r})));case 4:return n.abrupt("return",null);case 5:case"end":return n.stop()}}),null,this)}},{key:"getLatest",value:function(){var e=this;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){e.getStore().openCursor(IDBKeyRange.lowerBound(1),"prev").onsuccess=function(e){var cursor=e.target.result;if(cursor)var data={id:cursor.value.id,rawdata:cursor.value.data};t(data)}})));case 1:case"end":return t.stop()}}))}},{key:"getCount",value:function(){var e=this;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=e.getStore().count();r.onsuccess=function(){t(r.result)}})));case 1:case"end":return t.stop()}}))}},{key:"getAll",value:function(){var e=this;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=[];e.getStore().openCursor().onsuccess=function(e){var cursor=e.target.result;if(cursor){var data={id:cursor.value.id,lastModified:"",excerpt:""},n=cursor.value.data.split(";",3);data.lastModified=n[1],data.excerpt=n[2].substr(0,10)+"…",data.excerpt=data.excerpt.replace(/</g,"&lt;").replace(/>/g,"&gt;"),r.push(data),cursor.continue()}t(r)}})));case 1:case"end":return t.stop()}}))}},{key:"getFromTo",value:function(e,t){var n=this;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r,o){var c=n.getStore(),l=[],d=!0;c.openCursor(IDBKeyRange.lowerBound(1),"prev").onsuccess=function(n){var cursor=n.target.result;if(cursor)if(d&&e>1)cursor.advance(e),d=!1;else{d=!1;var data={id:cursor.value.id,lastModified:"",excerpt:""},o=cursor.value.data.split(";",3);data.lastModified=o[1],data.excerpt=o[2].substr(0,10)+"…",data.excerpt=data.excerpt.replace(/</g,"&lt;").replace(/>/g,"&gt;"),l.push(data),l.length<t&&cursor.continue()}r(l)}})));case 1:case"end":return r.stop()}}))}}])&&r(t.prototype,n),o&&r(t,o),e}();t.a=new o},153:function(e,t,n){"use strict";var r={props:{nowTop:{type:Boolean},nowMemos:{type:Boolean},nowNew:{type:Boolean}}},o=n(17),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{attrs:{id:"menu"}},[n("button",{staticClass:"button",class:{"is-primary":e.nowTop},on:{click:function(t){return e.$router.push("/")}}},[e._v("\n      Top\n   ")]),e._v(" "),n("button",{staticClass:"button",class:{"is-primary":e.nowMemos},on:{click:function(t){return e.$router.push("/memos/1/")}}},[e._v("\n      Memos\n   ")]),e._v(" "),n("button",{staticClass:"button",class:{"is-primary":e.nowNew},on:{click:function(t){return e.$router.push("/edit/0")}}},[e._v("\n      New\n   ")])])}),[],!1,null,null,null);t.a=component.exports},162:function(e,t,n){"use strict";n(18);var r=n(152),o={props:["inptxt","memoId","created","page"],data:function(){return{tmptxt:this.inptxt}},methods:{saveNewMemo:function(){var e,t,n,o;return regeneratorRuntime.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,regeneratorRuntime.awrap(r.a.connect());case 2:return e=c.sent,t=this.$ts2date(Math.floor((new Date).getTime()/1e3)),n=t+";"+t+";"+this.inptxt,e.add({data:n}),c.next=8,regeneratorRuntime.awrap(e.getLatest());case 8:(o=c.sent).id&&this.$router.push("/memos/edit/1/"+o.id+"?saved=new");case 10:case"end":return c.stop()}}),null,this)},saveMemo:function(){var e,t,n;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,regeneratorRuntime.awrap(r.a.connect());case 2:e=o.sent,t=this.$ts2date(Math.floor((new Date).getTime()/1e3)),n=this.created+";"+t+";"+this.inptxt,e.update(this.memoId,{data:n}),console.log("updated"),this.tmptxt=this.inptxt,this.$buefy.toast.open("保存しました。");case 9:case"end":return o.stop()}}),null,this)},resetMemo:function(){this.inptxt=this.tmptxt}},computed:{labeltxt:function(){var e="Create new memo.";return 0!=this.memoId&&(e="Edit memo."),e}}},c=n(17),component=Object(c.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{attrs:{id:"editview"}},[e.page?n("div",[n("nuxt-link",{attrs:{to:{name:"memos-page-id",params:{page:e.page,id:e.memoId}}}},[n("b-button",[e._v("<")])],1),e._v(" "),n("hr")],1):e._e(),e._v(" "),n("b",[e._v(e._s(e.labeltxt))]),e._v(" "),n("b-field",{attrs:{id:"inptxtarea"}},[n("b-input",{attrs:{type:"textarea",rows:"13"},model:{value:e.inptxt,callback:function(t){e.inptxt=t},expression:"inptxt"}},[e._v(e._s(e.inptxt))])],1),e._v(" "),0==e.memoId?n("div",{staticClass:"buttons"},[n("b-button",{attrs:{type:"is-primary"},on:{click:e.saveNewMemo}},[e._v("Save")]),e._v(" "),n("b-button",{attrs:{type:"is-danger",outlined:""},on:{click:e.resetMemo}},[e._v("Reset")])],1):n("div",{staticClass:"buttons"},[n("b-button",{attrs:{type:"is-primary"},on:{click:e.saveMemo}},[e._v("Save")]),e._v(" "),n("b-button",{attrs:{type:"is-danger",outlined:""},on:{click:e.resetMemo}},[e._v("Reset")])],1)],1)}),[],!1,null,"51a60162",null);t.a=component.exports},171:function(e,t,n){"use strict";n.r(t);n(98),n(18);var r=n(153),o=n(162),c=n(152),l={name:"Top",components:{myMenu:r.a,editView:o.a},asyncData:function(e){var t,n,r,o;return regeneratorRuntime.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,regeneratorRuntime.awrap(c.a.connect());case 2:return t=l.sent,l.next=5,regeneratorRuntime.awrap(t.get(parseInt(e.params.id)));case 5:return n=l.sent,r={memoId:0,inptxt:"",created:""},0!=n.id&&(r.memoId=n.id,o=n.rawdata.split(";",3),r.created=o[1],r.inptxt=o[2]),l.abrupt("return",r);case 9:case"end":return l.stop()}}))}},d=n(17),component=Object(d.a)(l,(function(){var e=this.$createElement,t=this._self._c||e;return t("section",{attrs:{id:"wrapper"}},[0==this.$route.params.id?t("div",[t("my-menu",{attrs:{nowNew:"true"}})],1):t("div",[t("my-menu",{attrs:{nowMemos:"true"}})],1),this._v(" "),t("section",{staticClass:"main-content columns"},[t("div",{staticClass:"container column is-12"},[t("section",{staticClass:"section"},[t("div",[t("edit-view",{attrs:{memoId:this.memoId,inptxt:this.inptxt,created:this.created}})],1)])])])])}),[],!1,null,null,null);t.default=component.exports}}]);