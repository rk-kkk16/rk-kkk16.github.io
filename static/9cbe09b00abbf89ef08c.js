(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{152:function(e,t,n){"use strict";n(68),n(98),n(13),n(18);function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"DB_NAME",get:function(){return"MemoDB"}},{key:"STORE_NAME",get:function(){return"memo"}}],(n=[{key:"connect",value:function(){var t=this;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,r){if(t.db)n(t);else{var o=indexedDB.open(e.DB_NAME);o.onupgradeneeded=function(t){t.target.result.createObjectStore(e.STORE_NAME,{keyPath:"id",autoIncrement:!0})},o.onsuccess=function(e){t.db=e.target.result,n(t)}}})));case 1:case"end":return n.stop()}}))}},{key:"getTransaction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"readwrite";return this.db.transaction(e,t)}},{key:"getStore",value:function(){return this.getTransaction([e.STORE_NAME]).objectStore(e.STORE_NAME)}},{key:"add",value:function(data){this.getStore().add(data).onsuccess=function(){console.log("save success.")}}},{key:"remove",value:function(e){console.log(e),this.getStore().delete(e).onsuccess=function(){console.log("delete success.")}}},{key:"update",value:function(e,data){data.id=e,this.getStore().put(data).onsuccess=function(){console.log("update success.")}}},{key:"get",value:function(e){var t=this;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,r){var o=t.getStore().get(e);o.onsuccess=function(){var e=o.result,t={id:0,rawdata:""};e&&(t.id=e.id,t.rawdata=e.data),n(t)},o.onerror=r})));case 4:return n.abrupt("return",null);case 5:case"end":return n.stop()}}),null,this)}},{key:"getLatest",value:function(){var e=this;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){e.getStore().openCursor(IDBKeyRange.lowerBound(1),"prev").onsuccess=function(e){var cursor=e.target.result;if(cursor)var data={id:cursor.value.id,rawdata:cursor.value.data};t(data)}})));case 1:case"end":return t.stop()}}))}},{key:"getCount",value:function(){var e=this;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=e.getStore().count();r.onsuccess=function(){t(r.result)}})));case 1:case"end":return t.stop()}}))}},{key:"getAll",value:function(){var e=this;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=[];e.getStore().openCursor().onsuccess=function(e){var cursor=e.target.result;if(cursor){var data={id:cursor.value.id,lastModified:"",excerpt:""},n=cursor.value.data.split(";",3);data.lastModified=n[1],data.excerpt=n[2].substr(0,10)+"…",data.excerpt=data.excerpt.replace(/</g,"&lt;").replace(/>/g,"&gt;"),r.push(data),cursor.continue()}t(r)}})));case 1:case"end":return t.stop()}}))}},{key:"getFromTo",value:function(e,t){var n=this;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r,o){var c=n.getStore(),l=[],f=!0;c.openCursor(IDBKeyRange.lowerBound(1),"prev").onsuccess=function(n){var cursor=n.target.result;if(cursor)if(f&&e>1)cursor.advance(e),f=!1;else{f=!1;var data={id:cursor.value.id,lastModified:"",excerpt:""},o=cursor.value.data.split(";",3);data.lastModified=o[1],data.excerpt=o[2].substr(0,10)+"…",data.excerpt=data.excerpt.replace(/</g,"&lt;").replace(/>/g,"&gt;"),l.push(data),l.length<t&&cursor.continue()}r(l)}})));case 1:case"end":return r.stop()}}))}}])&&r(t.prototype,n),o&&r(t,o),e}();t.a=new o},153:function(e,t,n){"use strict";var r={props:{nowTop:{type:Boolean},nowMemos:{type:Boolean},nowNew:{type:Boolean}}},o=n(17),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{attrs:{id:"menu"}},[n("button",{staticClass:"button",class:{"is-primary":e.nowTop},on:{click:function(t){return e.$router.push("/")}}},[e._v("\n      Top\n   ")]),e._v(" "),n("button",{staticClass:"button",class:{"is-primary":e.nowMemos},on:{click:function(t){return e.$router.push("/memos/1/")}}},[e._v("\n      Memos\n   ")]),e._v(" "),n("button",{staticClass:"button",class:{"is-primary":e.nowNew},on:{click:function(t){return e.$router.push("/edit/0")}}},[e._v("\n      New\n   ")])])}),[],!1,null,null,null);t.a=component.exports},163:function(e,t,n){"use strict";n(18);var r=n(152),o={props:["memoId","lastModified","textData","isTop","nowPage"],methods:{delConfirm:function(){this.$buefy.dialog.confirm({title:"メモの削除確認",message:"このメモを削除します。",confirmText:"OK",type:"is-danger",hasIcon:!0,props:{memoId:this.memoId},onConfirm:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(r.a.connect());case 2:e.sent.remove(this.props.memoId),location.href="/memos/1/?removed=1";case 5:case"end":return e.stop()}}),null,this)}})}}},c=n(17),component=Object(c.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{attrs:{id:"memoview"}},[this.memoId?n("div",[this.isTop?e._e():n("b-button",{staticStyle:{"margin-right":"20px"},on:{click:function(t){return e.$router.push("/memos/"+e.nowPage+"/")}}},[e._v("<")]),e._v(" "),n("b-button",{attrs:{type:"is-success",outlined:""},on:{click:function(t){return e.$router.push("/memos/edit/"+e.nowPage+"/"+e.memoId)}}},[e._v("Edit")]),e._v(" "),n("b-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"is-danger",outlined:""},on:{click:e.delConfirm}},[e._v("Delete")]),e._v(" "),n("hr")],1):e._e(),e._v(" "),n("p",[e._v("Last modified: "+e._s(e.lastModified))]),e._v(" "),n("hr"),e._v(" "),n("pre",[e._v(e._s(e.textData))])])}),[],!1,null,"1df3bd96",null);t.a=component.exports},174:function(e,t,n){"use strict";n.r(t);n(98),n(18);var r=n(153),o=n(163),c=n(152),l={name:"Top",asyncData:function(e){var t,n,r,o,l,f;return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(c.a.connect());case 2:return t=e.sent,e.next=5,regeneratorRuntime.awrap(t.getLatest());case 5:return n=e.sent,r=0,o="--",l="",n&&(r=n.id,f=n.rawdata.split(";",3),o=f[1],l=f[2]),e.abrupt("return",{fstMemoId:r,fstLastModified:o,fstTextData:l});case 11:case"end":return e.stop()}}))},data:function(){return{isTop:1,nowPage:1}},components:{myMenu:r.a,topView:o.a}},f=n(17),component=Object(f.a)(l,(function(){var e=this.$createElement,t=this._self._c||e;return t("section",{attrs:{id:"wrapper"}},[t("my-menu",{attrs:{nowTop:"true"}}),this._v(" "),t("section",{staticClass:"main-content columns"},[t("div",{staticClass:"container column is-12"},[t("section",{staticClass:"section"},[t("div",[t("top-view",{attrs:{memoId:this.fstMemoId,lastModified:this.fstLastModified,textData:this.fstTextData,isTop:this.isTop,nowPage:this.nowPage}})],1)])])])],1)}),[],!1,null,null,null);t.default=component.exports}}]);