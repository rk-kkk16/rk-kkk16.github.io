(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{152:function(e,t,n){"use strict";n(68),n(98),n(13),n(18);function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"DB_NAME",get:function(){return"MemoDB"}},{key:"STORE_NAME",get:function(){return"memo"}}],(n=[{key:"connect",value:function(){var t=this;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,r){if(t.db)n(t);else{var o=indexedDB.open(e.DB_NAME);o.onupgradeneeded=function(t){t.target.result.createObjectStore(e.STORE_NAME,{keyPath:"id",autoIncrement:!0})},o.onsuccess=function(e){t.db=e.target.result,n(t)}}})));case 1:case"end":return n.stop()}}))}},{key:"getTransaction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"readwrite";return this.db.transaction(e,t)}},{key:"getStore",value:function(){return this.getTransaction([e.STORE_NAME]).objectStore(e.STORE_NAME)}},{key:"add",value:function(data){this.getStore().add(data).onsuccess=function(){console.log("save success.")}}},{key:"remove",value:function(e){console.log(e),this.getStore().delete(e).onsuccess=function(){console.log("delete success.")}}},{key:"update",value:function(e,data){data.id=e,this.getStore().put(data).onsuccess=function(){console.log("update success.")}}},{key:"get",value:function(e){var t=this;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,r){var o=t.getStore().get(e);o.onsuccess=function(){var e=o.result,t={id:0,rawdata:""};e&&(t.id=e.id,t.rawdata=e.data),n(t)},o.onerror=r})));case 4:return n.abrupt("return",null);case 5:case"end":return n.stop()}}),null,this)}},{key:"getLatest",value:function(){var e=this;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){e.getStore().openCursor(IDBKeyRange.lowerBound(1),"prev").onsuccess=function(e){var cursor=e.target.result;if(cursor)var data={id:cursor.value.id,rawdata:cursor.value.data};t(data)}})));case 1:case"end":return t.stop()}}))}},{key:"getCount",value:function(){var e=this;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=e.getStore().count();r.onsuccess=function(){t(r.result)}})));case 1:case"end":return t.stop()}}))}},{key:"getAll",value:function(){var e=this;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=[];e.getStore().openCursor().onsuccess=function(e){var cursor=e.target.result;if(cursor){var data={id:cursor.value.id,lastModified:"",excerpt:""},n=cursor.value.data.split(";",3);data.lastModified=n[1],data.excerpt=n[2].substr(0,10)+"…",data.excerpt=data.excerpt.replace(/</g,"&lt;").replace(/>/g,"&gt;"),r.push(data),cursor.continue()}t(r)}})));case 1:case"end":return t.stop()}}))}},{key:"getFromTo",value:function(e,t){var n=this;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r,o){var c=n.getStore(),l=[],f=!0;c.openCursor(IDBKeyRange.lowerBound(1),"prev").onsuccess=function(n){var cursor=n.target.result;if(cursor)if(f&&e>1)cursor.advance(e),f=!1;else{f=!1;var data={id:cursor.value.id,lastModified:"",excerpt:""},o=cursor.value.data.split(";",3);data.lastModified=o[1],data.excerpt=o[2].substr(0,10)+"…",data.excerpt=data.excerpt.replace(/</g,"&lt;").replace(/>/g,"&gt;"),l.push(data),l.length<t&&cursor.continue()}r(l)}})));case 1:case"end":return r.stop()}}))}}])&&r(t.prototype,n),o&&r(t,o),e}();t.a=new o},153:function(e,t,n){"use strict";var r={props:{nowTop:{type:Boolean},nowMemos:{type:Boolean},nowNew:{type:Boolean}}},o=n(17),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{attrs:{id:"menu"}},[n("button",{staticClass:"button",class:{"is-primary":e.nowTop},on:{click:function(t){return e.$router.push("/")}}},[e._v("\n      Top\n   ")]),e._v(" "),n("button",{staticClass:"button",class:{"is-primary":e.nowMemos},on:{click:function(t){return e.$router.push("/memos/1/")}}},[e._v("\n      Memos\n   ")]),e._v(" "),n("button",{staticClass:"button",class:{"is-primary":e.nowNew},on:{click:function(t){return e.$router.push("/edit/0")}}},[e._v("\n      New\n   ")])])}),[],!1,null,null,null);t.a=component.exports},172:function(e,t,n){"use strict";n.r(t);n(18);var r=n(153),o=n(152),c={name:"Top",asyncData:function(e){var t,n,r,c,l;return regeneratorRuntime.async((function(f){for(;;)switch(f.prev=f.next){case 0:return t=parseInt(e.params.page),0==(n=10*(t-1))&&(n=1),f.next=5,regeneratorRuntime.awrap(o.a.connect());case 5:return r=f.sent,f.next=8,regeneratorRuntime.awrap(r.getFromTo(n,10));case 8:return c=f.sent,f.next=11,regeneratorRuntime.awrap(r.getCount());case 11:return l=f.sent,f.abrupt("return",{memos:c,totalCount:l});case 13:case"end":return f.stop()}}))},data:function(){return{nowPage:parseInt(this.$route.params.page),rangeBefore:2,rangeAfter:2,order:"is-centered",viewNum:10}},components:{myMenu:r.a},computed:{toastRemoved:function(){this.$route.query.removed&&this.$buefy.toast.open("メモを削除しました。")}}},l=n(17),component=Object(l.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{attrs:{id:"wrapper"}},[e._v("\n   "+e._s(e.toastRemoved)+"\n   "),n("my-menu",{attrs:{nowMemos:"true"}}),e._v(" "),n("section",{staticClass:"main-content columns"},[n("div",{staticClass:"container column is-12"},[n("section",{staticClass:"section"},[n("ul",e._l(e.memos,(function(t,r){return n("li",{key:"index",staticStyle:{"margin-bottom":"8px"},attrs:{memo:t}},[n("nuxt-link",{attrs:{to:{name:"memos-page-id",params:{page:e.$route.params.page,id:t.id}}}},[e._v("\n                "+e._s(t.lastModified)+" | "+e._s(t.excerpt)+"\n                ")])],1)})),0),e._v(" "),n("hr"),e._v(" "),n("div",[n("b-pagination",{attrs:{total:e.totalCount,current:e.nowPage,"per-page":e.viewNum,order:e.order,"range-before":e.rangeBefore,"range-after":e.rangeAfter},scopedSlots:e._u([{key:"default",fn:function(e){return n("b-pagination-button",{attrs:{page:e.page,id:"page"+e.page.number,tag:"router-link",to:"/memos/"+e.page.number+"/"}})}},{key:"previous",fn:function(t){return n("b-pagination-button",{attrs:{page:t.page,tag:"router-link",to:"/memos/"+t.page.number+"/"}},[e._v("\n                <\n                ")])}},{key:"next",fn:function(t){return n("b-pagination-button",{attrs:{page:t.page,tag:"router-link",to:"/memos/"+t.page.number+"/"}},[e._v("\n                >\n                ")])}}])})],1)])])])],1)}),[],!1,null,null,null);t.default=component.exports}}]);